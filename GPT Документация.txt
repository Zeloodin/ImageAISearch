Документация к коду:

Общее описание
Данный код представляет собой класс Generate_clip_features, который предназначен для генерации векторных представлений изображений с помощью модели CLIP (Contrastive Language-Image Pre-Training). Класс позволяет:

Находить и загружать изображения из указанных папок.
Создавать и сохранять векторные представления изображений в файл.
Осуществлять поиск изображений, похожих на заданное изображение или текстовый запрос.

Основные компоненты

Инициализация класса

Определение устройства для вычислений (GPU или CPU).
Загрузка модели CLIP и предобработчика изображений.
Установка параметров для сохранения результатов.
Загрузка векторных представлений изображений из файла.

Управление списком изображений

Методы folder_make_list, find_image_list и get_image_list для работы со списком изображений.
Использование класса Folder_make_list для фильтрации и поиска изображений.

Генерация векторных представлений

Метод create_clip_image_features для создания и сохранения векторных представлений изображений.
Использование функций exists_in_image_folder, sync_clip_image_features и exists_in_all_image_features для управления списком векторных представлений.
Метод get_features для извлечения векторных представлений изображений с помощью модели CLIP.

Поиск изображений

Метод searcher_clip для поиска изображений, похожих на заданное изображение или текстовый запрос.
Использование библиотеки hnswlib для эффективного поиска ближайших соседей.
Метод fit_NearestNeighbors для подготовки данных для поиска.

Вспомогательные функции

Статический метод convert_image для конвертации данных в изображение.
Функции save_pkl и load_pkl для сохранения и загрузки векторных представлений изображений.
Модуль core.tools.folder_tools для работы с файловой системой.